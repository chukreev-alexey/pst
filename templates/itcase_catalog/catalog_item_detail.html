{% extends 'base.html' %}

{% load fb_versions l10n static %}

{% block title %}
    {{ product.name }}
    {% for crumb in catalog_breadcrumbs %} | {{ crumb.name }} {% endfor %}
{% endblock title %}

{% block content %}
    <div class="nav">
        {% for crumb in catalog_breadcrumbs %}
            <div class="nav__item">
                <a href="{{ crumb.get_absolute_url }}"
                   class="nav__item-link">{{ crumb.name }}</a>
            </div>
        {% endfor %}
        <div class="nav__item nav__item_state_current">
            <div class="nav__item-text">{{ product.name }} {{ product.article }}</div>
        </div>
    </div>

    <div class="catalog-item-detail">
        <div class="catalog-item-detail__wrapper">
            <div class="catalog-item-detail__left">
                <div class="catalog-item-detail__gallery">
                    {% with images=product.get_images %}
                        {% if images %}
                            <div class="catalog-item-gallery">
                                <div class="catalog-item-gallery__image">
                                    <img src="{% version product.get_first_image.image 'catalog_detail' %}"
                                         class="catalog-item-gallery__image-image" alt="" title="" />
                                </div>
                                {% for price in product.prices.all %}
                                    {% if price.image %}
                                        <div class="catalog-item-gallery__image">
                                            <img src="{% version price.image 'catalog_detail' %}"
                                                 class="catalog-item-gallery__image-image" alt="" title="" />
                                        </div>
                                    {% endif %}
                                {% endfor %}
                                <div class="catalog-item-gallery-nav">
                                    {% for image in images %}
                                        <div class="catalog-item-gallery-nav__item{% if forloop.first %} catalog-item-gallery-nav__item_state_current{% endif %}">
                                            <img src="{% version image.image 'catalog_detail_thumb' %}" alt="" title="" />
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    {% endwith %}
                </div>
            </div>

            <div class="catalog-item-detail__right">
                <div class="catalog-item-detail__param">
                    <div class="catalog-item-detail__param-group">
                        <div class="catalog-item-detail__param-title">Группа параметров</div>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                    </div>

                    <div class="catalog-item-detail__param-group">
                        <div class="catalog-item-detail__param-title">Группа параметров</div>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                        <label class="catalog-item-detail__param-item">
                            <input type="radio" id="radioButton"class="catalog-item-detail__param-item-input" />
                            <div class="catalog-item-detail__param-item-text">Название параметра</div>
                        </label>
                    </div>
                </div>

                {% for price in product.prices.all %}
                    <div>
                        <p>{{ price.product_article }}: {{ price.price }}</p>

                        {% for param in price.price_combination.all %}
                           <p>{{ param }}</p>
                        {% endfor %}

                        {% with id=price.pk|unlocalize %}
                            <a href="{% url 'itcase_cart:cart_add' %}?product={{ id }}&amount-{{ id }}=1"
                               class="catalog-item__button button
                                      {% if price in cart %}
                                        button_border_orange
                                      {% else %}
                                        button_color_blue
                                      {% endif %}"
                                data-add-url="{% url 'itcase_cart:cart_add' %}"
                                data-product="{{ id }}"
                                data-amount-{{ id }}="1">
                                {% if price in cart %}
                                    В заказе
                                {% else %}
                                    Заказать
                                {% endif %}
                            </a>
                        {% endwith %}
                    </div>
                {% endfor %}

                <div class="catalog-item-detail__info">
                    {% if product.is_exist %}
                        <div class="catalog-item-detail__info-state catalog-item-detail__info-state_exist">
                            <div class="catalog-item-detail__info-state-text">В наличии</div>
                        </div>
                    {% else %}
                        <div class="catalog-item-detail__info-state">
                            <div class="catalog-item-detail__info-state-text">Под заказ</div>
                        </div>
                    {% endif %}
                    <div class="catalog-item-detail__info-price">
                        {{ product.price|floatformat:'-2' }} Р
                    </div>

                    {% with id=product.pk|unlocalize %}
                        <a href="{% url 'itcase_cart:cart_add' %}?product={{ id }}&amount-{{ id }}=1"
                           class="catalog-item__button button
                                  {% if product in cart %}
                                    button_border_orange
                                  {% else %}
                                    button_color_blue
                                  {% endif %}"
                            data-add-url="{% url 'itcase_cart:cart_add' %}"
                            data-product="{{ id }}"
                            data-amount-{{ id }}="1">
                            {% if product in cart %}
                                В заказе
                            {% else %}
                                Заказать
                            {% endif %}
                        </a>
                    {% endwith %}

                </div>
            </div>
        </div>

        {% if product.has_sections %}
            <div class="catalog-item-detail__tabs">
                <div class="catalog-item-detail__tabs-list">
                    {% for section in product.sections.all %}
                        {% if section.show %}
                            <div class="catalog-item-detail__tabs-list-item">
                                {{ section.section_name }}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                {% for section in product.sections.all %}
                    {% if section.show %}
                        <div class="catalog-item-detail__tabs-content content" {% if forloop.first %} style="display: block" {% endif %} >{{ section.section_content|safe }}</div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endif %}
    </div>

    {% include './include/catalog_related.html' %}
{% endblock %}

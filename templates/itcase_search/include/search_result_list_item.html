{% load fb_versions l10n itcase_common %}

<div class="search-result-list__item">
    <div class="search-result-list__item-wrapper">
        <div class="search-result-list__item-image">
            <a href="{{ item.get_absolute_url }}" class="search-result-list__item-image-link">
                <img src="{% version item.get_first_image 'search_result_thumb' %}"
                     class="search-result-list__item-image-image" alt="" title="" />
            </a>
        </div>
        <div class="search-result-list__item-inner">
            <div class="search-result-list__item-number">
                {% if page_obj %}
                    {{ forloop.counter0|add:page_obj.start_index }}
                {% else %}
                    {{ forloop.counter0 }}
                {% endif %}
            </div>

            <a href="{{ item.get_absolute_url }}" class="search-result-list__item-title">{{ item.highlighted.title }}</a>
            <div class="search-result-list__item-text">{{ item.highlighted.announce|safe }}</div>

            {% if item.price != 0 %}
                <div class="search-result-list__item-state search-result-list__item-state_exist">
                    <div class="search-result-list__item-state-text">В наличии</div>
                </div>
            {% else %}
                <div class="search-result-list__item-state">
                    <div class="search-result-list__item-state-text">Под заказ</div>
                </div>
            {% endif %}
            <div class="search-result-list__item-price">
                <div class="search-result-list__item-price-text">
                    {{ item.price|floatformat:'-2' }} Р
                </div>
                {% if item.old_price %}
                    <div class="search-result-list__item-price-old">
                        {{ item.old_price|floatformat:'-2' }} Р
                    </div>
                {% endif %}
            </div>
        </div>
        <div class="search-result-list__item-button">
            {% with id=item.pk|unlocalize %}
                <a href="{% url 'itcase_cart:cart_add' %}?item={{ id }}&amount-{{ id }}=1"
                   class="button button_type_primary"
                    data-add-url="{% url 'itcase_cart:cart_add' %}"
                    data-item="{{ id }}"
                    data-amount-{{ id }}="1">
                    <span class="button__text">
                        {% if item in cart %} В заказе {% else %} Заказать {% endif %}
                    </span>
                </a>
            {% endwith %}
        </div>
    </div>
</div>
